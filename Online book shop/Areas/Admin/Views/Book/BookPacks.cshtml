@using Online_book_shop.Models;
@using Online_book_shop.Handlers.Helper;
@using Online_book_shop.Handlers.Business;
@using Online_book_shop.Controllers;
@{
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
    List<ItemPack> packs = ViewBag.ItemPacks;
}

<h1>Book Packs</h1>
<table class="table">
    <thead>
        <tr>
            <th colspan="2" scope="col"><input class="col-lg-12" id="searchInput" type="text" placeholder="Search.."></th>
            <th scope="col"></th>
            <th scope="col"></th>
            <th scope="col"><a href="/Admin/Book/AddBookPack" class="btn btn-xs btn-info">New Book Pack</a></th>
            @if (Request.QueryString["hidden"] != null && Request.QueryString["hidden"] == "true")
            {
                <th scope="col"><a href="/Admin/AddBookPack" class="btn btn-xs btn-warning">Hide hidden book pack</a></th>
            }
            else
            {
                <th scope="col"><a href="/Admin/AddBookPack?hidden=true" class="btn btn-xs btn-info">Show hidden book packs</a></th>
            }

        </tr>
    </thead>
    <thead>
        <tr>
            <th scope="col">Book Pack Id</th>
            <th scope="col">Front Cover</th>
            <th scope="col">Title</th>
            <th scope="col">Price</th>
            <th scope="col">Created date</th>
            <th scope="col">Operation</th>
        </tr>
    </thead>
    <tbody>
        @foreach (ItemPack book in packs)
        {
           // List<BookProperties> bps = BusinessHandlerBookProperties.GetByBookId(book.Id);
            <tr class="author-card">
                <th scope="row">@book.Id</th>
                <td>
                    @{
                        Media m = BusinessHandlerMedia.Get(book.FrontCoverMediaId);
                        if (m != null && HTMLHelper.isImageExist("/Content/UploadFiles/Images/BookFrontCover/" + m.FileName))
                        {
                            <img src="@Url.Action("ResizeImage", "AdminUtility", new {FileName="~/Content/UploadFiles/Images/BookFrontCover/"+m.FileName,width=67,height=102})" height="100" alt="" />
                            @*<img  src = "/Content/UploadFiles/Images/BookFrontCover/@m.FileName" height = "100" alt = "" />*@
                        }
                        else
                        {
                            <img height="100" src="~/Content/images/NoImage.jpg">

                        }
                    }


                </td>
                <td>@book.Title</td>
                <td>@book.Price</td>
                <td>@book.CreatedDate.ToString("yyyy/MM/dd")</td>
                <td>
                    <a href="/Admin/Book/editBookPack/@book.Id" class="btn-xs btn-info">Edit Book</a><br /><br />
                    @if (book.isDeleted)
                    {
                        <a href="/Admin/Book/ShowBookPack/@book.Id" class="btn-xs btn-warning">Show In Site</a>
                    }
                    else
                    {
                        <a href="/Admin/Book/HideBookPack/@book.Id" class="btn-xs btn-danger">Hide From Site</a>
                    }
                </td>
            </tr>
        }

    </tbody>
</table>
