@using Online_book_shop.Models;
@using Online_book_shop.Handlers.Business;
@using Online_book_shop.Handlers.Helper;
@{
    ViewBag.Title = "Index";
    List<UserReview> UserReviews = ViewBag.list;
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
    double timeOffset = BusinessHandlerConfigurations.GetTimeOffSet();
}
<h1>Reviews</h1>

<table class="table">
    <thead>
        <tr>
            <th colspan="3" scope="col"><input class="col-lg-12" id="searchInput" type="text" placeholder="Search.."></th>
            <th scope="col"></th>
            <th scope="col"></th>
            <th scope="col"></th>
            <th scope="col">
                @if (!string.IsNullOrEmpty(Request.QueryString["filter"]) && Request.QueryString["filter"] == "all")
                {
                    <a href="/Admin/ManageUserReviews" class="btn btn-info">Show Unapproved</a>
                }
                else
                {
                    <a href="/Admin/ManageUserReviews?filter=all" class="btn btn-info">Show All</a>
                }

            </th>
        </tr>
    </thead>
    <thead>
        <tr>
            <th scope="col">Review Id</th>
            <th scope="col">Comment</th>
            <th scope="col">Book Id</th>
            <th scope="col">Created date</th>
            <th scope="col">Operation</th>
        </tr>
    </thead>
    <tbody>
        @foreach (UserReview review in UserReviews)
        {
            var obj = BusinessHandlerBook.Get(review.ObjectId);
            var user = BusinessHandlerUser.GetUserById(review.UserId);
        <tr class="author-card">
            <th scope="row">@review.Id</th>
            <td>@review.UserComment : by @(user!=null? user.UserName:"")</td>
            <td>@(obj !=null? obj.Title:"")</td>
            <td>@review.CreatedDate.AddHours(timeOffset).ToString("yyyy/MM/dd")</td>
            <td>
                @*<a href="/Admin/Author/EditAuthor/@review.Id" class="btn-sm btn-info">Edit</a>*@
                @if (review.isApproved)
                {
                    <a href="/Admin/ManageUserReviews/ShowItem/@review.Id" class="btn-xs btn-success">Unapprove</a>
                }
                else
                {
                    <a href="/Admin/ManageUserReviews/HideItem/@review.Id" class="btn-xs btn-danger">Approve</a>
                }
            </td>
        </tr>
        }

    </tbody>
</table>
